#include <stdio.h>
#include <string.h>
#include <stdlib.h>
#include <conio.h>
#include <windows.h>
#include <dos.h>
void coordinate(int x, int y) {
    COORD CRD;
    CRD.X= x;
    CRD.Y= y;
    SetConsoleCursorPosition(GetStdHandle(STD_OUTPUT_HANDLE),CRD);
}
struct user {
    char name[32];
    char ID[16];
    char number[16];
    char email[32];
    char user_name[32];
    char password[32];
    };
    typedef struct user Suser;
login() {
        char username[30],password[20];
        int i;
        FILE *user;
        user=fopen("user.txt","r");
        Suser log;

    coordinate(20,1);
    printf("\nPlease Enter your login Details below\n\n");
    printf("Username:  ");
    scanf("%s",&username);
    printf("\nPassword: ");
    scanf("%s",&password);

while(fread(&log,sizeof(log),1,user)){
    if(strcmp(username,log.user_name)==0 && strcmp(password,log.password)==0)
        {
            printf("\nSuccessful Login\n");
            home();
            break;
        }
    else
        {
            printf("\nIncorrect Login Details\nPlease enter the correct Information\n");
            login();
            break;
        }
}
    fclose(user);
}
profile_information(){
    FILE *data;
        data=fopen("data.txt","r");
        Suser log;
        int opener;

        if(NULL== data){
            printf("No Information Available");
            home();
        }
        do{
                opener= fgetc(data);
        printf("%c",opener);
            }
            while(opener!=EOF);
            fclose(data);
            return 0;
}
home(){
    printf("Hello User!\n");
    printf("Please Select the Option: \n\n \t 1.See Profile Information\n\t\ 2.Update Profile\n\t 3.Book Ticket\n\t 4.Cancel Reservation\n\t 5.Check Your Trip\n\n");
    int option;
    scanf("%d",&option);

    switch(option){

case 1:
    profile_information();
    break;
case 2:
    //update_profile();
    break;
case 3:
    //book_ticket();
    break;
case 4:
    //cancel_reservation();
    break;
case 5:
    //check_trip();
    break;
default:
    home();
    }
}
create_profile(){
    char name[32];
    FILE *data;
    data=fopen("data.txt","w");
    Suser create;

    coordinate(15,5);


     printf("\n");
     printf("\n\t\t\t  **-**-**-**-**-**-**-**-**-**-**-**-**-**-**-**-**-**-**");
     printf("\n\t\t\t              Welcome to BR Online Ticketing!");
     printf("\n\t\t\t               Please Fill the Data Below");
     printf("\n\t\t\t  **-**-**-**-**-**-**-**-**-**-**-**-**-**-**-**-**-**-**");

     fgetc(stdin);
    printf("\n\n\t\t\t\tEnter Your Full Name:");
    fgets(create.name,32,stdin);
    create.name[strlen(create.name)-1]=0;
    printf("\n\n\t\t\t\tEnter Your ID:");
    fgets(create.ID,16,stdin);
    create.ID[strlen(create.ID)-1]=0;
    printf("\n\n\t\t\t\tEnter Your Mobile Number: ");
    fgets(create.number,16,stdin);
    create.number[strlen(create.number)-1]=0;
    printf("\n\n\t\t\t\tEnter Your E-mail Address: ");
    fgets(create.email,32,stdin);
    create.email[strlen(create.email)-1]=0;

    //getchar();
    system("CLS");
    coordinate(15,5);

    printf("\n");
     printf("\n\t\t\t\t\tYour Information:    ");

        printf("\n\n\t\t\t *******************************************\n");
        printf("\n\t\t\t            Name: ");
        puts(create.name);
        printf("\n\t\t\t            ID: ");
        puts(create.ID);
        printf("\n\t\t\t            Mobile Number: ");
        puts(create.number);
        printf("\n\t\t\t            Email: ");
        puts(create.email);
        printf("\n\n\t\t\t *******************************************\n");

int option;
    printf("\n\n\t\t\tEnter 1 to Save info or 2 to Cancel: ");
    scanf("%d",&option);

     system("CLS");
    coordinate(15,10);

    if(option==1)
{
    getchar();
    system("CLS");
    coordinate(15,5);

    printf("\n");
    printf("\n\t\t\t  **-**-**-**-**-**-**-**-**-**-**-**-**-**-**-**-**-**-****-**-**");
    printf("\n\t\t\t        #-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#");
    printf("\n\t\t\t        #                                                 #");
    printf("\n\t\t\t        #            Welcome to Bangladesh Railway        #");
    printf("\n\t\t\t        #          Your information have been Saved!      #");
    printf("\n\t\t\t        #                                                 #");
    printf("\n\t\t\t        #-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#");
    printf("\n\t\t\t  **-**-**-**-**-**-**-**-**-**-**-**-**-**-**-**-**-**-****-**-**\n");
    fwrite(&create,sizeof(create),1,data);
    fclose(data);

    printf("\n");
     printf("\n\t\t\t\t  ................................................");
     printf("\n\t\t\t\t  <  Please Create Your Username & Set Password >");
     printf("\n\t\t\t\t  ................................................");

     FILE *user;
    user=fopen("user.txt","w");
    Suser userinfo;

    printf("\n\n\n\t\t\tEnter Username:");
        scanf("%s",userinfo.user_name);
    printf("\n\n\n\t\t\tEnter Password:");
    scanf("%s",userinfo.password);

    fwrite(&userinfo,sizeof(userinfo),1,user);
    fclose(user);

printf("\nRegistration Successful!\n");
printf("Press 'ENTER' key to continue...");
}
else if(option==2){
    getchar();
system("CLS");
coordinate(15,10);
main();
}
else
    printf("Wrong Choice!");
system("CLS");
    coordinate(15,10);
    int choice;
    printf("Enter 1 to go to 'Main Menu' or Enter 2 to go to 'Login'\n\n");
    scanf("%d",&choice);
    if(choice==1) {
            getchar();
            system("CLS");
    coordinate(15,10);
    main();}
    if(choice==2) {
            getchar();
    system("CLS");
    coordinate(15,10);
    login();
    }}
int main(){
    
    int newfile[1000];
        system("COLOR 70");

        printf("\n\n\n\n\n");
    printf("\n\t\t\t  **-**-**-**-**-**-**-**-**-**-**-**-**-**-**-**-**-**-**");
    printf("\n\t\t\t        #-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#");
    printf("\n\t\t\t        #                                           #");
    printf("\n\t\t\t        #                  WELCOME                  #");
    printf("\n\t\t\t        #                    TO                     #");
    printf("\n\t\t\t        #             Railway Ticketing             #");
    printf("\n\t\t\t        #                  SYSTEM                   #");
    printf("\n\t\t\t        #                                           #");
    printf("\n\t\t\t        #-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#");
    printf("\n\t\t\t  **-**-**-**-**-**-**-**-**-**-**-**-**-**-**-**-**-**-**\n");
    printf("\n\n\n\t\t\t Enter any key to continue.....");
    getchar();
        system("CLS");

        int choice,option;
        coordinate(15,10);


        printf("\n");
    printf("\n\t\t\t  **-**-**-**-**-**-**-**-**-**-**-**-**-**-**-**-**-**-**");
    printf("\n\t\t\t        #-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#");
    printf("\n\t\t\t        #                                           #");
    printf("\n\t\t\t        #               Choose Your option:         #");
    printf("\n\t\t\t        #               1. User                     #");
    printf("\n\t\t\t        #               2. Admin                    #");
    printf("\n\t\t\t        #               3. About                    #");
    printf("\n\t\t\t        #                                           #");
    printf("\n\t\t\t        #-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#");
    printf("\n\t\t\t  **-**-**-**-**-**-**-**-**-**-**-**-**-**-**-**-**-**-**\n");
    printf("\n\t\t\t Enter Your option to continue.....");
        scanf("%d",&choice);

        getchar();
        system("CLS");
        coordinate(15,10);
switch(choice){
case 1:
    {
    printf("\n");
    printf("\n\t\t\t  **-**-**-**-**-**-**-**-**-**-**-**-**-**-**-**-**-**-**");
    printf("\n\t\t\t        #-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#");
    printf("\n\t\t\t        #                                           #");
    printf("\n\t\t\t        #            Choose Your Option:            #");
    printf("\n\t\t\t        #            1. Create Profile              #");
    printf("\n\t\t\t        #            2. Log in                      #");
    printf("\n\t\t\t        #            3. Back to Home Page           #");
    printf("\n\t\t\t        #                                           #");
    printf("\n\t\t\t        #-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#");
    printf("\n\t\t\t  **-**-**-**-**-**-**-**-**-**-**-**-**-**-**-**-**-**-**");
    printf("\nt\t\t Enter Your option to continue.....");
    scanf("%d",&option);
    switch(option)
    {
    case 1:
         {
        system("CLS");
        create_profile();
        break;
    }

    case 2:
        {
        system("CLS");
        login();
        break;
        }
    case 3:
        {
            system("CLS");
            main();
            break;
        }
    default:
        {
            system("CLS");
            main();
            break;
        }
    }
    break;
}
    case 2:
        {
            printf("Admin Access is Under Development\n\n");
            int back;
            printf("Choose 1 to go back or Press Any Key to EXIT!\n");
            scanf("%d",&back);
            switch(back)
            {
            case 1:{
                    system("CLS");
                    coordinate(15,10);
                main();
                }
            default:
                return 0;
            }
        break;
        }
        case 3:
            {
                printf("About Loading...........\n");
                printf("Press Any Key to Go back to Home Page\n");
                getchar();
        system("CLS");
               main();
               break;
            }

    default:
        printf("Wrong Option!");
    }}
